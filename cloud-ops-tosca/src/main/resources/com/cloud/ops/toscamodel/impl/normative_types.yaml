# Copyright 2015 Universita' di Pisa
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#     http://www.apache.org/licenses/LICENSE-2.0
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
tosca_definitions_version: tosca_simple_yaml_1_0_0

datatype_definitions:
    tosca.types.NodeNetworkInfo:
        properties:
            outbound_bandwidth:
                type: scalar-unit
            inbound_bandwidth:
                type: scalar-unit
            load_balancing:
                type: boolean
            number_of_ipv4:
                type: integer
    
    tosca.types.Location:
        properties: {}
        
    tosca.types.Location.Europe:
        derived_from: tosca.types.Location
    
    tosca.types.QosRequirements:
        properties:
            response_time:
                    type: scalar-unit
            execution_time:
                    type: scalar-unit
            availability:
                    type: float

                
    tosca.types.QosInfo:
        properties:
          benchmark_platform:
            type: string
          execution_time:
            type: scalar-unit            

    tosca.types.os:
        properties:
            load_balancing:
                type: boolean
    
    tosca.types.os.linux:
        derived_from: tosca.types.os
    
    tosca.types.os.linux.ubuntu:
        derived_from: tosca.types.os.linux




node_types:
    tosca.nodes.VM:
        derived_from: tosca.nodes.Root
        properties:
            mem_size:
                type: scalar-unit
            num_cpus:
                type: integer
            disk_size:
                type: scalar-unit
            availability:
                type: float
    
    tosca.nodes.Platform:
        derived_from: tosca.nodes.Root
        properties:
            java_support:
                type: boolean
                default: false
            java_version:
                type: string
                default: ''

    tosca.nodes.Logic:
        derived_from: tosca.nodes.Root
        properties:
            qos_requirements:
                type: tosca.types.QosRequirements
            qos_info:
                type: tosca.types.QosInfo

    tosca.nodes.Compute:
        derived_from: tosca.nodes.VM
        properties:
            scaling_horizontal:
                type: string
                constraints:
                    - valid_values: [ no, manual, auto]
                default: no
            scaling_vertical:
                type: string
                constraints:
                    - valid_values: [no,manual,auto]
                default: no
            storage_type:
                type: string
                default: ''
                # (tbd)
            storage_file_system:
                type: string
                default: ''
                # (maybe not needed)
            region:
                type: string
                #tosca.types.Location
                default: ''
            networking:
                type: tosca.types.NodeNetworkInfo
                default:
                    outbound_bandwidth: 2 MB
                    inbound_bandwidth: 1 MB
                    load_balancing: false
                    number_of_ipv4: 1
            applicationEnvironment:
                type: string
                # tosca.types.Location
            disk_type:
                type: string
                #constraints:
                 #   - valid values: ['sata', 'pata']
            load_balancing:
                type: boolean
            local_storage:
                type: scalar-unit
                #constraints:
                 #   - greater_or_equal: 0 TB
  
#    tosca.nodes.Compute.Amazon:
#      derived_from: tosca.nodes.Compute

    tosca.nodes.Compute.HP:
      derived_from: tosca.nodes.Compute

    tosca.nodes.Compute.Local:
      derived_from: tosca.nodes.Compute
      properties:
              hosts:
                type: list
              user:
                type: string
              password:
                type: string

    tosca.nodes.deploy:
      derived_from: tosca.nodes.Root

    tosca.nodes.deploy.MySQL:
        derived_from: tosca.nodes.deploy
        properties:
            port:
                type: string
            db_name:
                type: string
            db_user:
                type: string
            db_password:
                type: string
            version:
                type: string

    tosca.nodes.deploy.JAVA:
        derived_from: tosca.nodes.deploy
        properties:
            java_home:
                type: string

    tosca.nodes.deploy.Tomcat:
        derived_from: tosca.nodes.deploy
        properties:
            tomcat_home:
                type: string
            user:
                type: string
            password:
                type: string

    tosca.nodes.deploy.War:
        derived_from: tosca.nodes.deploy